# 開発者向けドキュメント (DEV_DOC)

## 環境構築手順
1. **前提条件**:
   - Docker Engine および Docker Compose がインストールされていること。
   - `make` コマンドが利用可能であること。
2. **ドメイン解決**:
   - ホストマシンの `/etc/hosts` に `127.0.0.1 kosakats.42.fr` を追加することで、ローカル環境からドメイン名でアクセス可能です。
3. **環境変数**:
   - `srcs/.env` ファイルを作成し、必要なデータベースパスワードやドメイン名を設定してください。

## Makefile / Docker Compose 使用方法
開発効率化のため、`Makefile` に以下のショートカットが定義されています。

- `make` (または `make up`): `docker compose up --build` を実行し、コンテナを構築・起動します。
- `make down`: コンテナとネットワークを停止・削除します。
- `make logs`: 全コンテナのログを表示します。
- `make clean`: `down` に加え、ボリューム（永続化データ）を削除します。
- `make fclean`: `clean` に加え、Docker システムの不要なイメージ等を削除 (`prune`) します。
- `make re`: 環境を再構築 (`down` -> `up`) します。

## コンテナ・ボリューム管理
`srcs/docker-compose.yml` に基づき、以下の構成で管理されます。

- **コンテナ**: サービスごとに独立したコンテナ (Nginx, WordPress, MariaDB) が起動します。
- **ネットワーク**: `inception` ネットワーク内でコンテナ間の名前解決（DNS）が行われます。

## データ永続化の説明
Docker Volume を使用して、コンテナのライフサイクルとは独立してデータを保持します。

- **WordPress ファイル**: `/var/www/html` にマウントされ、プラグインやアップロード画像を保持します。
- **データベース**: `/var/lib/mysql` にマウントされ、記事データやユーザー情報を保持します。
- **注意**: `make down` ではデータは消えませんが、`make clean` を実行するとこれらのボリュームも削除され、データは初期化されます。